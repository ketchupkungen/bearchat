(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{262:function(e,a,t){e.exports=t(554)},552:function(e,a,t){},553:function(e,a,t){},554:function(e,a,t){"use strict";t.r(a);var n=t(20),r=t(21),s=t(23),l=t(22),o=t(24),c=t(0),i=t.n(c),u=t(17),d=t.n(u),m=t(30),h=t(3),p=t(252),f=t(155),g=t.n(f);t(427),t(429),t(555);g.a.initializeApp({apiKey:"AIzaSyCsOHr1Y2l35wSYt_Zg8vE7inO_9O30p1c",authDomain:"bearchat-app.firebaseapp.com",databaseURL:"https://bearchat-app.firebaseio.com",projectId:"bearchat-app",storageBucket:"bearchat-app.appspot.com",messagingSenderId:"465344246644",appId:"1:465344246644:web:4622decaba1f840b"});var v=g.a,E=t(239),C=t.n(E),b=function(e){function a(){var e,t;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(t=Object(s.a)(this,(e=Object(l.a)(a)).call.apply(e,[this].concat(o)))).state={user:t.props.currentUser,modal:!1,previewImage:"",croppedImage:"",blob:null,uploadedCroppedImage:"",storageRef:v.storage().ref(),userRef:v.auth().currentUser,usersRef:v.database().ref("users"),metadata:{contentType:"image/jpeg"}},t.openModal=function(){return t.setState({modal:!0})},t.closeModal=function(){return t.setState({modal:!1})},t.uploadCroppedImage=function(){var e=t.state,a=e.storageRef,n=e.userRef,r=e.blob,s=e.metadata;a.child("avatars/users/".concat(n.uid)).put(r,s).then(function(e){e.ref.getDownloadURL().then(function(e){t.setState({uploadedCroppedImage:e},function(){return t.changeAvatar()})})})},t.changeAvatar=function(){t.state.userRef.updateProfile({photoURL:t.state.uploadedCroppedImage}).then(function(){console.log("PhotoURL updated"),t.closeModal()}).catch(function(e){console.error(e)}),t.state.usersRef.child(t.state.user.uid).update({avatar:t.state.uploadedCroppedImage}).then(function(){console.log("User avatar updated")}).catch(function(e){console.error(e)})},t.handleChange=function(e){var a=e.target.files[0],n=new FileReader;a&&(n.readAsDataURL(a),n.addEventListener("load",function(){t.setState({previewImage:n.result})}))},t.handleCropImage=function(){t.avatarEditor&&t.avatarEditor.getImageScaledToCanvas().toBlob(function(e){var a=URL.createObjectURL(e);t.setState({croppedImage:a,blob:e})})},t.handleSignout=function(){v.auth().signOut().then(function(){return console.log("signed out!")})},t.toggle=function(){t.setState({modal:!t.state.modal})},t}return Object(o.a)(a,e),Object(r.a)(a,[{key:"render",value:function(){var e=this,a=this.state,t=a.user,n=(a.modal,a.previewImage),r=a.croppedImage;return i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("h2",null,"BearChat")),i.a.createElement(h.h,null,i.a.createElement(h.k,{className:"user-toggle",caret:!0,color:"dark"},i.a.createElement("img",{className:"sidebar-avatar",src:t.photoURL}),t.displayName),i.a.createElement(h.j,{basic:!0,className:"user-toggle"},i.a.createElement(h.i,{disabled:!0},"Signed in as ",i.a.createElement("strong",null,this.state.user.displayName)),i.a.createElement(h.i,{onClick:this.openModal},"Change Avatar"),i.a.createElement(h.i,{divider:!0}),i.a.createElement(h.i,{onClick:this.handleSignout},"Sign Out"))),i.a.createElement(h.p,{className:"form-dark avatar-modal",contentClassName:"card card-image",isOpen:this.state.modal,toggle:this.toggle},i.a.createElement(h.s,{toggle:this.toggle},"Upload and crop avatar"),i.a.createElement(h.q,null,i.a.createElement("div",null,i.a.createElement("input",{onChange:this.handleChange,type:"file",label:"New Avatar",style:{paddingBottom:"20px"}})),i.a.createElement("div",null,n&&i.a.createElement(C.a,{ref:function(a){return e.avatarEditor=a},image:n,width:100,height:100,border:50,borderRadius:50,scale:2,style:{display:"block",marginLeft:"auto",marginRight:"auto",borderRadius:"5px"}})),i.a.createElement("div",null,r&&i.a.createElement("img",{style:{display:"block",marginLeft:"auto",marginRight:"auto",borderRadius:"50px"},width:100,height:100,src:r}))),i.a.createElement("div",{className:"avatar-modal-footer1"},i.a.createElement(h.b,{outline:!0,color:"danger",onClick:this.toggle},"Cancel"),i.a.createElement(h.b,{outline:!0,onClick:this.handleCropImage},"Preview")),r&&i.a.createElement("div",{className:"avatar-modal-footer2"},i.a.createElement(h.b,{color:"success",onClick:this.uploadCroppedImage},i.a.createElement("i",{className:"save"}),"Change avatar")),i.a.createElement(h.r,{className:"avatar-modal-footer"},i.a.createElement(h.b,{outline:!0,color:"danger",onClick:this.toggle},"Cancel"),i.a.createElement(h.b,{outline:!0,onClick:this.handleCropImage},"Preview"),r&&i.a.createElement(h.b,{outline:!0,color:"success",onClick:this.uploadCroppedImage},i.a.createElement("i",{className:"save"}),"Change Avatar"))))}}]),a}(i.a.Component),y=t(60),N=t(36),k=function(e){return{type:"SET_CURRENT_CHANNEL",payload:{currentChannel:e}}},w=function(e){return{type:"SET_PRIVATE_CHANNEL",payload:{isPrivateChannel:e}}},S=function(e){function a(){var e,t;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(t=Object(s.a)(this,(e=Object(l.a)(a)).call.apply(e,[this].concat(o)))).state={activeChannel:"",user:t.props.currentUser,channel:null,channels:[],channelName:"",channelDetails:"",channelsRef:v.database().ref("channels"),messagesRef:v.database().ref("messages"),typingRef:v.database().ref("typing"),notifications:[],modal:!1,firstLoad:!0,collapseID:""},t.addListeners=function(){var e=[];t.state.channelsRef.on("child_added",function(a){e.push(a.val()),t.setState({channels:e},function(){return t.setFirstChannel()}),t.addNotificationListener(a.key)})},t.addNotificationListener=function(e){t.state.messagesRef.child(e).on("value",function(a){t.state.channel&&t.handleNotifications(e,t.state.channel.id,t.state.notifications,a)})},t.handleNotifications=function(e,a,n,r){var s=0,l=n.findIndex(function(a){return a.id===e});-1!==l?(e!==a&&(s=n[l].total,r.numChildren()-s>0&&(n[l].count=r.numChildren()-s)),n[l].lastKnownTotal=r.numChildren()):n.push({id:e,total:r.numChildren(),lastKnownTotal:r.numChildren(),count:0}),t.setState({notifications:n})},t.removeListeners=function(){t.state.channelsRef.off(),t.state.channels.forEach(function(e){t.state.messagesRef.child(e.id).off()})},t.setFirstChannel=function(){var e=t.state.channels[0];t.state.firstLoad&&t.state.channels.length>0&&(t.props.setCurrentChannel(e),t.setActiveChannel(e),t.setState({channel:e})),t.setState({firstLoad:!1})},t.addChannel=function(){var e=t.state,a=e.channelsRef,n=e.channelName,r=e.channelDetails,s=e.user,l=a.push().key,o={id:l,name:n,details:r,createdBy:{name:s.displayName,avatar:s.photoURL}};a.child(l).update(o).then(function(){t.setState({channelName:"",channelDetails:""}),t.closeModal(),console.log("channel added")}).catch(function(e){console.error(e)})},t.handleSubmit=function(e){e.preventDefault(),t.isFormValid(t.state)&&t.addChannel()},t.handleChange=function(e){t.setState(Object(N.a)({},e.target.name,e.target.value))},t.changeChannel=function(e){t.setActiveChannel(e),t.state.typingRef.child(t.state.channel.id).child(t.state.user.uid).remove(),t.clearNotifications(),t.props.setCurrentChannel(e),t.props.setPrivateChannel(!1),t.setState({channel:e})},t.clearNotifications=function(){var e=t.state.notifications.findIndex(function(e){return e.id===t.state.channel.id});if(-1!==e){var a=Object(y.a)(t.state.notifications);a[e].total=t.state.notifications[e].lastKnownTotal,a[e].count=0,t.setState({notifications:a})}},t.setActiveChannel=function(e){t.setState({activeChannel:e.id})},t.getNotificationCount=function(e){var a=0;if(t.state.notifications.forEach(function(t){t.id===e.id&&(a=t.count)}),a>0)return a},t.displayChannels=function(e){return e.length>0&&e.map(function(e){return i.a.createElement(h.b,{color:"dark",key:e.id,onClick:function(){return t.changeChannel(e)},name:e.name,active:e.id===t.state.activeChannel,className:"sidebar-dropdown-item"},t.getNotificationCount(e)&&i.a.createElement("p",{style:{color:"green",background:"black"}},t.getNotificationCount(e)),"#",e.name)})},t.isFormValid=function(e){var a=e.channelName,t=e.channelDetails;return a&&t},t.openModal=function(){return t.setState({modal:!0})},t.closeModal=function(){return t.setState({modal:!1})},t.toggleCollapse=function(e){return function(){return t.setState(function(a){return{collapseID:a.collapseID!==e?e:""}})}},t.toggle=function(){t.setState({modal:!t.state.modal})},t}return Object(o.a)(a,e),Object(r.a)(a,[{key:"componentDidMount",value:function(){this.addListeners()}},{key:"componentWillUnmount",value:function(){this.removeListeners()}},{key:"render",value:function(){var e=this.state,a=e.channels,t=(e.modal,e.collapseID);return i.a.createElement(i.a.Fragment,null,i.a.createElement(h.c,{className:"sidebar-dropdown"},i.a.createElement(h.f,{className:"sidebar-category"},"Channels "," "," (",a.length,")",i.a.createElement(h.b,{className:"add-channel",onClick:this.openModal,color:"dark"},i.a.createElement("i",{className:"fas fa-plus fa-2x"})),i.a.createElement(h.b,{onClick:this.toggleCollapse("collapse2"),className:"dropdown-arrow",color:"dark"},i.a.createElement("i",{className:"collapse2"===t?"fa fa-angle-down rotate-icon fa-2x":"fa fa-angle-down fa-2x"}))),i.a.createElement(h.e,{id:"collapse2",isOpen:t},i.a.createElement(h.d,{className:"sidebar-dropdown-menu"},this.displayChannels(a)))),i.a.createElement(h.p,{className:"form-dark channel-modal",isOpen:this.state.modal,toggle:this.toggle},i.a.createElement(h.s,{toggle:this.toggle},"Create a channel"),i.a.createElement(h.q,null,i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement("div",null,i.a.createElement(h.n,{icon:"fas fa-book",label:"Name of Channel",name:"channelName",onChange:this.handleChange})),i.a.createElement("div",null,i.a.createElement(h.n,{icon:"fas fa-book-open",label:"About the Channel",name:"channelDetails",onChange:this.handleChange})))),i.a.createElement(h.r,null,i.a.createElement(h.b,{outline:!0,color:"danger",onClick:this.toggle},"Cancel"),i.a.createElement(h.b,{outline:!0,color:"success",onClick:this.handleSubmit},"Create"))))}}]),a}(i.a.Component),O=Object(m.b)(null,{setCurrentChannel:k,setPrivateChannel:w})(S),j=function(e){function a(){var e,t;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(t=Object(s.a)(this,(e=Object(l.a)(a)).call.apply(e,[this].concat(o)))).state={activeChannel:"",user:t.props.currentUser,users:[],usersRef:v.database().ref("users"),connectedRef:v.database().ref(".info/connected"),presenceRef:v.database().ref("presence"),collapseID:""},t.removeListeners=function(){t.state.usersRef.off(),t.state.presenceRef.off(),t.state.connectedRef.off()},t.addListeners=function(e){var a=[];t.state.usersRef.on("child_added",function(n){if(e!==n.key){var r=n.val();r.uid=n.key,r.status="offline",a.push(r),t.setState({users:a})}}),t.state.connectedRef.on("value",function(a){if(!0===a.val()){var n=t.state.presenceRef.child(e);n.set(!0),n.onDisconnect().remove(function(e){null!==e&&console.error(e)})}}),t.state.presenceRef.on("child_added",function(a){e!==a.key&&t.addStatusToUser(a.key)}),t.state.presenceRef.on("child_removed",function(a){e!==a.key&&t.addStatusToUser(a.key,!1)})},t.addStatusToUser=function(e){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t.state.users.reduce(function(t,n){return n.uid===e&&(n.status="".concat(a?"online":"offline")),t.concat(n)},[]);t.setState({users:n})},t.isUserOnline=function(e){return"online"===e.status},t.changeChannel=function(e){var a={id:t.getChannelId(e.uid),name:e.name};t.props.setCurrentChannel(a),t.props.setPrivateChannel(!0),t.setActiveChannel(e.uid)},t.getChannelId=function(e){var a=t.state.user.uid;return e<a?"".concat(e,"/").concat(a):"".concat(a,"/").concat(e)},t.setActiveChannel=function(e){t.setState({activeChannel:e})},t.toggleCollapse=function(e){return function(){return t.setState(function(a){return{collapseID:a.collapseID!==e?e:""}})}},t}return Object(o.a)(a,e),Object(r.a)(a,[{key:"componentDidMount",value:function(){this.state.user&&this.addListeners(this.state.user.uid)}},{key:"componentWillUnmount",value:function(){this.removeListeners()}},{key:"render",value:function(){var e=this,a=this.state,t=a.users,n=a.activeChannel,r=a.collapseID;return i.a.createElement(h.c,{className:"sidebar-dropdown"},i.a.createElement(h.f,{className:"sidebar-category"},"Private message "," "," (",t.length,")",i.a.createElement(h.b,{onClick:this.toggleCollapse("collapse3"),className:"dropdown-arrow",color:"dark"},i.a.createElement("i",{className:"collapse3"===r?"fa fa-angle-down rotate-icon fa-2x":"fa fa-angle-down fa-2x"}))),i.a.createElement(h.e,{id:"collapse3",isOpen:r},i.a.createElement(h.d,{className:"sidebar-dropdown-menu"},t.map(function(a){return i.a.createElement(h.b,{color:"dark",key:a.uid,active:a.uid===n,onClick:function(){return e.changeChannel(a)},style:{opacity:.7,fontStyle:"italic"},className:"sidebar-dropdown-item"},i.a.createElement(h.m,{icon:"power-off",className:e.isUserOnline(a)?"user-online":"user-offline"}),a.name)}))))}}]),a}(i.a.Component),U=Object(m.b)(null,{setCurrentChannel:k,setPrivateChannel:w})(j),R=t(55),P=function(e){function a(){var e,t;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(t=Object(s.a)(this,(e=Object(l.a)(a)).call.apply(e,[this].concat(o)))).state={user:t.props.currentUser,usersRef:v.database().ref("users"),activeChannel:"",starredChannels:[],collapseID:""},t.removeListener=function(){t.state.usersRef.child("".concat(t.state.user.uid,"/starred")).off()},t.addListeners=function(e){t.state.usersRef.child(e).child("starred").on("child_added",function(e){var a=Object(R.a)({id:e.key},e.val());t.setState({starredChannels:[].concat(Object(y.a)(t.state.starredChannels),[a])})}),t.state.usersRef.child(e).child("starred").on("child_removed",function(e){var a=Object(R.a)({id:e.key},e.val()),n=t.state.starredChannels.filter(function(e){return e.id!==a.id});t.setState({starredChannels:n})})},t.setActiveChannel=function(e){t.setState({activeChannel:e.id})},t.changeChannel=function(e){t.setActiveChannel(e),t.props.setCurrentChannel(e),t.props.setPrivateChannel(!1)},t.displayChannels=function(e){return e.length>0&&e.map(function(e){return i.a.createElement(h.b,{color:"dark",key:e.id,onClick:function(){return t.changeChannel(e)},name:e.name,active:e.id===t.state.activeChannel,className:"sidebar-dropdown-item"},"#",e.name)})},t.toggleCollapse=function(e){return function(){return t.setState(function(a){return{collapseID:a.collapseID!==e?e:""}})}},t}return Object(o.a)(a,e),Object(r.a)(a,[{key:"componentDidMount",value:function(){this.state.user&&this.addListeners(this.state.user.uid)}},{key:"componentWillUnmount",value:function(){this.removeListener()}},{key:"render",value:function(){var e=this.state,a=e.starredChannels,t=e.collapseID;return i.a.createElement(h.c,{className:"sidebar-dropdown"},i.a.createElement(h.f,{className:"sidebar-category"},"Favorite Channels "," "," (",a.length,")",i.a.createElement(h.b,{onClick:this.toggleCollapse("collapse1"),className:"dropdown-arrow",color:"dark"},i.a.createElement("i",{className:"collapse1"===t?"fa fa-angle-down rotate-icon fa-2x":"fa fa-angle-down fa-2x"}))),i.a.createElement(h.e,{id:"collapse1",isOpen:t},i.a.createElement(h.d,{className:"sidebar-dropdown-menu"},this.displayChannels(a))))}}]),a}(i.a.Component),I=Object(m.b)(null,{setCurrentChannel:k,setPrivateChannel:w})(P),L=function(e){function a(e){var t;return Object(n.a)(this,a),(t=Object(s.a)(this,Object(l.a)(a).call(this,e))).state={show:!0,collapseID:""},t.toggleCollapse=function(e){return function(){return t.setState(function(a){return{collapseID:a.collapseID!==e?e:""}})}},t.toggleSidebar=function(){t.setState({show:!t.state.show})},t.state={isOpen:!1},t}return Object(o.a)(a,e),Object(r.a)(a,[{key:"render",value:function(){var e=this,a=this.props.currentUser;this.state.collapseID;return i.a.createElement("div",null,i.a.createElement(h.b,{color:"dark",onClick:this.toggleSidebar,className:"toggle-mobile-navbar"},i.a.createElement(h.m,{icon:"bars",size:"3x"})),i.a.createElement("div",{className:"mobile-sidebar"},i.a.createElement(p.a,{in:this.state.show,timeout:0},function(t){return i.a.createElement("div",{className:"sidebar-box"},i.a.createElement("nav",{className:"sidebar sidebar-".concat(t)},i.a.createElement(b,{currentUser:a}),i.a.createElement(h.g,{className:"md-accordion mt-5 sidebar-dropdown"},i.a.createElement(I,{currentUser:a}),i.a.createElement(O,{currentUser:a}),i.a.createElement(U,{currentUser:a}))),i.a.createElement("div",{className:"screenHide screenHide-".concat(t),onClick:e.toggleSidebar}))})),i.a.createElement("div",{className:"desk-sidebar"},i.a.createElement(b,{currentUser:a}),i.a.createElement(h.g,{className:"md-accordion mt-5 sidebar-dropdown"},i.a.createElement(I,{currentUser:a}),i.a.createElement(O,{currentUser:a}),i.a.createElement(U,{currentUser:a}))))}}]),a}(i.a.Component),A=(t(145),t(32)),T=t(251),x=function(e){function a(){var e,t;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(t=Object(s.a)(this,(e=Object(l.a)(a)).call.apply(e,[this].concat(o)))).state={channel:t.props.currentChannel,privateChannel:t.props.isPrivateChannel,activeIndex:0,collapseID:"collapse1"},t.setActiveIndex=function(e,a){var n=a.index,r=t.state.activeIndex===n?-1:n;t.setState({activeIndex:r})},t.formatCount=function(e){return"".concat(e,e>1||0===e?" posts":" post")},t.displayTopPosters=function(e){return Object.entries(e).sort(function(e,a){return a[1]-e[1]}).map(function(e,a){var n=Object(T.a)(e,2),r=n[0],s=n[1];return i.a.createElement("div",{style:{background:"none"},key:a},i.a.createElement("img",{className:"message-avatar",src:s.avatar}),i.a.createElement("a",{className:"message-author"},r),i.a.createElement("div",{className:"message-time"},t.formatCount(s.count)))}).slice(0,2)},t.toggleCollapse=function(e){return function(){return t.setState(function(a){return{collapseID:a.collapseID!==e?e:""}})}},t}return Object(o.a)(a,e),Object(r.a)(a,[{key:"render",value:function(){var e=this.state,a=(e.activeIndex,e.privateChannel),t=e.channel,n=this.props.userPosts;return a?null:i.a.createElement("div",null,i.a.createElement(h.c,{style:{backgroundColor:"rgba(0,0,0,.03)"},className:"my-1"},i.a.createElement(h.f,{onClick:this.toggleCollapse("collapse1")},i.a.createElement("span",{className:"white-text"},"Channel Details"),i.a.createElement(h.m,{icon:"collapse1"===this.state.collapseID?"angle-up":"angle-down",className:"white-text",style:{float:"right"}})),i.a.createElement(h.e,{id:"collapse1",isOpen:this.state.collapseID},i.a.createElement(h.d,{className:"rgba-grey-light white-text"},t&&t.details))),i.a.createElement(h.c,{style:{backgroundColor:"rgba(0,0,0,.03)"}},i.a.createElement(h.f,{onClick:this.toggleCollapse("collapse2")},i.a.createElement("span",{className:"white-text"},"Top Posters"),i.a.createElement(h.m,{icon:"collapse2"===this.state.collapseID?"angle-up":"angle-down",className:"white-text",style:{float:"right"}})),i.a.createElement(h.e,{id:"collapse2",isOpen:this.state.collapseID},i.a.createElement(h.d,{className:"rgba-grey-light white-text"},i.a.createElement(h.o,null,n&&this.displayTopPosters(n))))),i.a.createElement(h.c,{style:{backgroundColor:"rgba(0,0,0,.03)"}},i.a.createElement(h.f,{onClick:this.toggleCollapse("collapse3")},i.a.createElement("span",{className:"white-text"},"Created By"),i.a.createElement(h.m,{icon:"collapse3"===this.state.collapseID?"angle-up":"angle-down",className:"white-text",style:{float:"right"}})),i.a.createElement(h.e,{id:"collapse3",isOpen:this.state.collapseID},i.a.createElement(h.d,{className:"rgba-grey-light white-text"},i.a.createElement("img",{className:"message-avatar",src:t&&t.createdBy.avatar}),i.a.createElement("a",{className:"message-author"},t&&t.createdBy.name)))))}}]),a}(i.a.Component),D=function(e){function a(){var e,t;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(t=Object(s.a)(this,(e=Object(l.a)(a)).call.apply(e,[this].concat(o)))).state={isOpen:!1,modal:!1},t.toggleCollapse=function(){t.setState({isOpen:!t.state.isOpen})},t.toggle=function(){t.setState({modal:!t.state.modal})},t}return Object(o.a)(a,e),Object(r.a)(a,[{key:"render",value:function(){var e=this.props,a=e.channelName,t=e.numUniqueUsers,n=e.handleSearchChange,r=e.searchLoading,s=e.isPrivateChannel,l=e.handleStar,o=e.isChannelStarred,c=(e.currentUser,e.currentChannel),u=e.userPosts;return i.a.createElement("div",null,i.a.createElement(A.a,null,i.a.createElement(h.w,{className:"lobby-navbar",color:"black",dark:!0,expand:"md"},i.a.createElement(h.e,{id:"navbarCollapse3",isOpen:this.state.isOpen,navbar:!0},i.a.createElement(h.y,{left:!0},i.a.createElement(h.u,null,i.a.createElement(h.x,null,i.a.createElement("strong",{className:"white-text"},a,!s&&i.a.createElement("i",{onClick:l,className:o?"fas fa-star":"far fa-star",size:"lg"}))),i.a.createElement(h.x,null,i.a.createElement("small",{className:"white-text"},t))),i.a.createElement(h.u,null,i.a.createElement(h.v,{onClick:this.toggle,className:"waves-effect waves-light d-flex align-items-center",to:"#!"},i.a.createElement(h.m,{icon:"info"})))),i.a.createElement(h.y,{right:!0},i.a.createElement(h.u,null,i.a.createElement(h.l,{waves:!0},i.a.createElement("div",{className:"md-form my-0"},i.a.createElement("input",{loading:r,onChange:n,className:"form-control mr-sm-2",type:"text",name:"searchTerm",placeholder:"Search Messages","aria-label":"Search"}))))))),i.a.createElement(h.t,{className:"mobile-lobby-navbar",color:"black"},i.a.createElement(h.u,null,i.a.createElement("h5",{className:"white-text"},a,!s&&i.a.createElement("i",{onClick:l,className:o?"fas fa-star":"far fa-star",size:"lg"}))),i.a.createElement(h.u,null,i.a.createElement(h.h,null,i.a.createElement(h.k,{nav:!0,caret:!0},i.a.createElement("span",{className:"mr-2"})),i.a.createElement(h.j,null,i.a.createElement(h.i,null,t),i.a.createElement(h.i,{onClick:this.toggle,className:"waves-effect waves-light d-flex align-items-center",to:"#!"},i.a.createElement("p",null,"Information"))))),i.a.createElement(h.u,null,i.a.createElement(h.l,{waves:!0,style:{float:"right"}},i.a.createElement("div",{className:"md-form my-0"},i.a.createElement("input",{loading:r,onChange:n,className:"form-control mr-sm-2",type:"text",name:"searchTerm",placeholder:"Search Messages","aria-label":"Search"})))))),i.a.createElement(h.p,{className:"form-dark",isOpen:this.state.modal,toggle:this.toggle},i.a.createElement(h.s,{toggle:this.toggle},"About ",a),i.a.createElement(h.q,null,i.a.createElement(x,{key:c&&c.name,userPosts:u,currentChannel:c,isPrivateChannel:s}))))}}]),a}(i.a.Component),M=Object(m.b)(function(e){return{currentUser:e.user.currentUser,currentChannel:e.channel.currentChannel,isPrivateChannel:e.channel.isPrivateChannel,userPosts:e.channel.userPosts}})(D),_=t(240),F=t.n(_),B=t(159),W=(t(434),t(156)),z=t.n(W),V=function(e){function a(){var e,t;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(t=Object(s.a)(this,(e=Object(l.a)(a)).call.apply(e,[this].concat(o)))).state={file:null,authorized:["image/jpeg","image/png","image/gif","image/webp"],modal:!1},t.addFile=function(e){var a=e.target.files[0];a&&t.setState({file:a})},t.sendFile=function(){var e=t.state.file,a=t.props,n=a.uploadFile,r=a.closeModal;null!==e&&(t.isAuthorized(e.name)&&(n(e,{contentType:z.a.lookup(e.name)}),r(),t.clearFile()))},t.isAuthorized=function(e){return t.state.authorized.includes(z.a.lookup(e))},t.clearFile=function(){return t.setState({file:null})},t.toggle=function(){t.setState({modal:!t.state.modal})},t}return Object(o.a)(a,e),Object(r.a)(a,[{key:"render",value:function(){var e=this.props;e.modal,e.closeModal;return i.a.createElement("span",null,i.a.createElement(h.b,{color:"black",onClick:this.toggle,icon:"cloud upload",className:"message-button"},"Upload"),i.a.createElement(h.p,{className:"form-dark",contentClassName:"card card-image",isOpen:this.state.modal,toggle:this.toggle},i.a.createElement(h.s,{toggle:this.toggle},"Upload Image or gif"),i.a.createElement(h.q,null,i.a.createElement("input",{onChange:this.addFile,label:"File types: jpg, png, gif",name:"file",type:"file"})),i.a.createElement(h.r,null,i.a.createElement(h.b,{outline:!0,color:"danger",onClick:this.toggle},"Cancel"),i.a.createElement(h.b,{outline:!0,color:"success",onClick:this.sendFile},"Send"))))}}]),a}(i.a.Component),q=function(e){var a=e.uploadState,t=e.percentUploaded;return"uploading"===a&&i.a.createElement(h.z,{material:!0,animated:!0,percent:t})},H=function(e){function a(){var e,t;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(t=Object(s.a)(this,(e=Object(l.a)(a)).call.apply(e,[this].concat(o)))).state={storageRef:v.storage().ref(),typingRef:v.database().ref("typing"),uploadTask:null,uploadState:"",percentUploaded:0,message:"",channel:t.props.currentChannel,user:t.props.currentUser,loading:!1,errors:[],modal:!1,emojiPicker:!1},t.openModal=function(){return t.setState({modal:!0})},t.closeModal=function(){return t.setState({modal:!1})},t.handleChange=function(e){t.setState(Object(N.a)({},e.target.name,e.target.value))},t.handleKeyDown=function(e){13===e.keyCode&&t.sendMessage();var a=t.state,n=a.message,r=a.typingRef,s=a.channel,l=a.user;n?r.child(s.id).child(l.uid).set(l.displayName):r.child(s.id).child(l.uid).remove()},t.handleTogglePicker=function(){t.setState({emojiPicker:!t.state.emojiPicker})},t.handleAddEmoji=function(e){var a=t.state.message,n=t.colonToUnicode(" ".concat(a," ").concat(e.colons," "));t.setState({message:n,emojiPicker:!1}),setTimeout(function(){return t.messageInputRef.focus()},0)},t.colonToUnicode=function(e){return e.replace(/:[A-Za-z0-9_+-]+:/g,function(e){e=e.replace(/:/g,"");var a=B.b.emojis[e];if("undefined"!==typeof a){var t=a.native;if("undefined"!==typeof t)return t}return e=":"+e+":"})},t.createMessage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a={timestamp:v.database.ServerValue.TIMESTAMP,user:{id:t.state.user.uid,name:t.state.user.displayName,avatar:t.state.user.photoURL}};return null!==e?a.image=e:a.content=t.state.message,a},t.sendMessage=function(){var e=t.props.getMessagesRef,a=t.state,n=a.message,r=a.channel,s=a.user,l=a.typingRef;n?(t.setState({loading:!0}),e().child(r.id).push().set(t.createMessage()).then(function(){t.setState({loading:!1,message:"",errors:[]}),l.child(r.id).child(s.uid).remove()}).catch(function(e){console.error(e),t.setState({loading:!1,errors:t.state.errors.concat(e)})})):t.setState({errors:t.state.errors.concat({message:"Add a message"})})},t.getPath=function(){return t.props.isPrivateChannel?"chat/private/".concat(t.state.channel.id):"chat/public"},t.uploadFile=function(e,a){var n=t.state.channel.id,r=t.props.getMessagesRef(),s="".concat(t.getPath(),"/").concat(F()(),".jpg");t.setState({uploadState:"uploading",uploadTask:t.state.storageRef.child(s).put(e,a)},function(){t.state.uploadTask.on("state_changed",function(e){var a=Math.round(e.bytesTransferred/e.totalBytes*100);t.setState({percentUploaded:a})},function(e){console.error(e),t.setState({errors:t.state.errors.concat(e),uploadState:"error",uploadTask:null})},function(){t.state.uploadTask.snapshot.ref.getDownloadURL().then(function(e){t.sendFileMessage(e,r,n)}).catch(function(e){console.error(e),t.setState({errors:t.state.errors.concat(e),uploadState:"error",uploadTask:null})})})})},t.sendFileMessage=function(e,a,n){a.child(n).push().set(t.createMessage(e)).then(function(){t.setState({uploadState:"done"})}).catch(function(e){console.error(e),t.setState({errors:t.state.errors.concat(e)})})},t.toggle=function(){t.setState({modal:!t.state.modal})},t}return Object(o.a)(a,e),Object(r.a)(a,[{key:"componentWillUnmount",value:function(){null!==this.state.uploadTask&&(this.state.uploadTask.cancel(),this.setState({uploadTask:null}))}},{key:"render",value:function(){var e=this,a=this.state,t=a.errors,n=a.message,r=a.loading,s=a.modal,l=a.uploadState,o=a.percentUploaded,c=a.emojiPicker;return i.a.createElement("div",{className:"message-form"},c&&i.a.createElement(B.a,{set:"apple",onSelect:this.handleAddEmoji,className:"emojipicker",title:"Pick your emoji",emoji:"point_up"}),i.a.createElement(h.b,{color:"dark",id:"emoji-btn",onClick:this.handleTogglePicker},c?i.a.createElement("i",{className:"emoji-close fas fa-times fa-3x"}):i.a.createElement("i",{className:"emoji-open fas fa-laugh fa-3x"})),i.a.createElement("div",{style:{marginLeft:"60px"}},i.a.createElement("input",{type:"text",name:"message",onChange:this.handleChange,onKeyDown:this.handleKeyDown,value:n,ref:function(a){return e.messageInputRef=a},autoComplete:"off",placeholder:"Write your message",className:t.some(function(e){return e.message.includes("message")})?"error":""})),i.a.createElement(h.b,{color:"black",onClick:this.sendMessage,disabled:r,icon:"edit",className:"message-button"},"Send"),i.a.createElement(V,{modal:s,closeModal:this.closeModal,uploadFile:this.uploadFile}),i.a.createElement(q,{uploadState:l,percentUploaded:o}))}}]),a}(i.a.Component),K=t(68),Y=t.n(K),J=function(e,a){return e.user.id===a.uid?"message-content":""},Z=function(e){var a,t=e.message,n=e.user;return i.a.createElement("div",{className:"message"},i.a.createElement("hr",null),i.a.createElement("img",{className:"message-avatar",src:t.user.avatar}),i.a.createElement("a",{className:"message-author"},t.user.name),i.a.createElement("div",{className:"message-time"},(a=t.timestamp,Y()(a).fromNow())),i.a.createElement("div",{className:J(t,n)},function(e){return e.hasOwnProperty("image")&&!e.hasOwnProperty("message-content")}(t)?i.a.createElement("img",{src:t.image,className:"message-image"}):i.a.createElement("div",{className:"message-text"},t.content)))},$=function(){return i.a.createElement("div",{className:"typing"},i.a.createElement("div",{className:"typing__dot"}),i.a.createElement("div",{className:"typing__dot"}),i.a.createElement("div",{className:"typing__dot"}))},G=function(){return i.a.createElement("div",{className:"skeleton"},i.a.createElement("div",{className:"skeleton__avatar"}),i.a.createElement("div",{className:"skeleton__author"}),i.a.createElement("div",{className:"skeleton__details"}))},Q=function(e){function a(){var e,t;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(t=Object(s.a)(this,(e=Object(l.a)(a)).call.apply(e,[this].concat(o)))).state={privateChannel:t.props.isPrivateChannel,privateMessagesRef:v.database().ref("privateMessages"),messagesRef:v.database().ref("messages"),messages:[],messagesLoading:!0,channel:t.props.currentChannel,isChannelStarred:!1,user:t.props.currentUser,usersRef:v.database().ref("users"),numUniqueUsers:"",searchTerm:"",searchLoading:!1,searchResults:[],typingRef:v.database().ref("typing"),typingUsers:[],connectedRef:v.database().ref(".info/connected"),listeners:[]},t.removeListeners=function(e){e.forEach(function(e){e.ref.child(e.id).off(e.event)})},t.addToListeners=function(e,a,n){if(-1===t.state.listeners.findIndex(function(t){return t.id===e&&t.ref===a&&t.event===n})){var r={id:e,ref:a,event:n};t.setState({listeners:t.state.listeners.concat(r)})}},t.scrollToBottom=function(){t.messagesEnd.scrollIntoView({behavior:"smooth"})},t.addListeners=function(e){t.addMessageListener(e),t.addTypingListeners(e)},t.addTypingListeners=function(e){var a=[];t.state.typingRef.child(e).on("child_added",function(e){e.key!==t.state.user.uid&&(a=a.concat({id:e.key,name:e.val()}),t.setState({typingUsers:a}))}),t.addToListeners(e,t.state.typingRef,"child_added"),t.state.typingRef.child(e).on("child_removed",function(e){-1!==a.findIndex(function(a){return a.id===e.key})&&(a=a.filter(function(a){return a.id!==e.key}),t.setState({typingUsers:a}))}),t.addToListeners(e,t.state.typingRef,"child_removed"),t.state.connectedRef.on("value",function(a){!0===a.val()&&t.state.typingRef.child(e).child(t.state.user.uid).onDisconnect().remove(function(e){null!==e&&console.error(e)})})},t.addMessageListener=function(e){var a=[],n=t.getMessagesRef();n.child(e).on("child_added",function(e){a.push(e.val()),t.setState({messages:a,messagesLoading:!1}),t.countUniqueUsers(a),t.countUserPosts(a)}),t.addToListeners(e,n,"child_added")},t.addUserStarsListener=function(e,a){t.state.usersRef.child(a).child("starred").once("value").then(function(a){if(null!==a.val()){var n=Object.keys(a.val()).includes(e);t.setState({isChannelStarred:n})}})},t.getMessagesRef=function(){var e=t.state,a=e.messagesRef,n=e.privateMessagesRef;return e.privateChannel?n:a},t.handleStar=function(){t.setState(function(e){return{isChannelStarred:!e.isChannelStarred}},function(){return t.starChannel()})},t.starChannel=function(){t.state.isChannelStarred?t.state.usersRef.child("".concat(t.state.user.uid,"/starred")).update(Object(N.a)({},t.state.channel.id,{name:t.state.channel.name,details:t.state.channel.details,createdBy:{name:t.state.channel.createdBy.name,avatar:t.state.channel.createdBy.avatar}})):t.state.usersRef.child("".concat(t.state.user.uid,"/starred")).child(t.state.channel.id).remove(function(e){null!==e&&console.error(e)})},t.handleSearchChange=function(e){t.setState({searchTerm:e.target.value,searchLoading:!0},function(){return t.handleSearchMessages()})},t.handleSearchMessages=function(){var e=Object(y.a)(t.state.messages),a=new RegExp(t.state.searchTerm,"gi"),n=e.reduce(function(e,t){return(t.content&&t.content.match(a)||t.user.name.match(a))&&e.push(t),e},[]);t.setState({searchResults:n}),setTimeout(function(){return t.setState({searchLoading:!1})},1e3)},t.countUniqueUsers=function(e){var a=e.reduce(function(e,a){return e.includes(a.user.name)||e.push(a.user.name),e},[]),n=a.length>1||0===a.length,r="".concat(a.length," user").concat(n?"s":"");t.setState({numUniqueUsers:r})},t.countUserPosts=function(e){var a=e.reduce(function(e,a){return a.user.name in e?e[a.user.name].count+=1:e[a.user.name]={avatar:a.user.avatar,count:1},e},{});t.props.setUserPosts(a)},t.displayMessages=function(e){return e.length>0&&e.map(function(e){return i.a.createElement(Z,{key:e.timestamp,message:e,user:t.state.user})})},t.displayChannelName=function(e){return e?"".concat(t.state.privateChannel?"@":"#").concat(e.name):""},t.displayTypingUsers=function(e){return e.length>0&&e.map(function(e){return i.a.createElement("div",{style:{display:"flex",alignItems:"center",marginBottom:"0.2em"},key:e.id},i.a.createElement("span",{className:"user__typing"},e.name," is typing")," ",i.a.createElement($,null))})},t.displayMessageSkeleton=function(e){return e?i.a.createElement(i.a.Fragment,null,Object(y.a)(Array(10)).map(function(e,a){return i.a.createElement(G,{key:a})})):null},t}return Object(o.a)(a,e),Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=this.state,a=e.channel,t=e.user,n=e.listeners;a&&t&&(this.removeListeners(n),this.addListeners(a.id),this.addUserStarsListener(a.id,t.uid))}},{key:"componentWillUnmount",value:function(){this.removeListeners(this.state.listeners),this.state.connectedRef.off()}},{key:"componentDidUpdate",value:function(e,a){this.messagesEnd&&this.scrollToBottom()}},{key:"render",value:function(){var e=this,a=this.state,t=a.messagesRef,n=a.messages,r=a.channel,s=a.user,l=a.numUniqueUsers,o=a.searchTerm,c=a.searchResults,u=(a.searchLoading,a.privateChannel),d=a.isChannelStarred,m=a.typingUsers,h=a.messagesLoading;return i.a.createElement(i.a.Fragment,null,i.a.createElement(M,{channelName:this.displayChannelName(r),numUniqueUsers:l,handleSearchChange:this.handleSearchChange,isPrivateChannel:u,handleStar:this.handleStar,isChannelStarred:d}),i.a.createElement("div",{className:"chat-modal"},i.a.createElement("div",{className:"messages"},this.displayMessageSkeleton(h),o?this.displayMessages(c):this.displayMessages(n),this.displayTypingUsers(m),i.a.createElement("div",{ref:function(a){return e.messagesEnd=a}}))),i.a.createElement(H,{className:"message-form",messagesRef:t,currentChannel:r,currentUser:s,isPrivateChannel:u,getMessagesRef:this.getMessagesRef}))}}]),a}(i.a.Component),X=Object(m.b)(null,{setUserPosts:function(e){return{type:"SET_USER_POSTS",payload:{userPosts:e}}}})(Q),ee=Object(m.b)(function(e){return{currentUser:e.user.currentUser,currentChannel:e.channel.currentChannel,isPrivateChannel:e.channel.isPrivateChannel,userPosts:e.channel.userPosts}})(function(e){var a=e.currentUser,t=e.currentChannel,n=e.isPrivateChannel;e.userPosts;return i.a.createElement("div",{className:"lobby-background"},i.a.createElement(L,{key:a&&a.uid,currentUser:a}),i.a.createElement(X,{key:t&&t.id,currentChannel:t,currentUser:a,isPrivateChannel:n}))}),ae=Object(m.b)(function(e){return{currentUser:e.user.currentUser,currentChannel:e.channel.currentChannel,isPrivateChannel:e.channel.isPrivateChannel,userPosts:e.channel.userPosts}})(function(e){e.currentUser,e.currentChannel,e.isPrivateChannel,e.userPosts;return i.a.createElement("div",{className:"profile-page"})}),te=function(e){function a(){return Object(n.a)(this,a),Object(s.a)(this,Object(l.a)(a).apply(this,arguments))}return Object(o.a)(a,e),Object(r.a)(a,[{key:"render",value:function(){return i.a.createElement(h.a,{color:"elegant-color-dark",className:"font-small footer"},i.a.createElement("div",{className:"footer-copyright text-center"},i.a.createElement("ul",{className:"list-unstyled list-inline"},i.a.createElement("li",{className:"list-inline-item"},"\xa9 ",(new Date).getFullYear()," Copyright:",i.a.createElement("a",{href:"http://www.ketchupkungen.se"}," ketchupkungen.se")),i.a.createElement("li",{className:"list-inline-item"},i.a.createElement("a",{href:"https://ketchupkungen.se/",className:"btn-floating btn-sm btn-tw  footer-link"},i.a.createElement(h.m,{fab:!0,icon:"facebook-f"}))),i.a.createElement("li",{className:"list-inline-item"},i.a.createElement("a",{href:"https://ketchupkungen.se/",className:"btn-floating btn-sm btn-li footer-link"},i.a.createElement(h.m,{fab:!0,icon:"instagram"}))))))}}]),a}(c.Component),ne=function(e){function a(){var e,t;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(t=Object(s.a)(this,(e=Object(l.a)(a)).call.apply(e,[this].concat(o)))).state={email:"",password:"",errors:[],loading:!1},t.displayErrors=function(e){return e.map(function(e,a){return i.a.createElement("p",{key:a},e.message)})},t.handleChange=function(e){t.setState(Object(N.a)({},e.target.name,e.target.value))},t.handleSubmit=function(e){e.preventDefault(),t.isFormValid(t.state)&&(t.setState({errors:[],loading:!0}),v.auth().signInWithEmailAndPassword(t.state.email,t.state.password).then(function(e){console.log(e)}).catch(function(e){console.error(e),t.setState({errors:t.state.errors.concat(e),loading:!1})}))},t.isFormValid=function(e){var a=e.email,t=e.password;return a&&t},t.handleInputError=function(e,a){return e.some(function(e){return e.message.toLowerCase().includes(a)})?"error":""},t}return Object(o.a)(a,e),Object(r.a)(a,[{key:"render",value:function(){var e=this.state,a=e.email,t=e.password,n=e.errors;e.loading;return i.a.createElement("div",null,i.a.createElement("div",{className:"login-page-desk"},i.a.createElement(h.c,{className:"login-card"},i.a.createElement(h.d,null,i.a.createElement("h2",null,"BearChat"),i.a.createElement("p",{style:{color:"#A9A9A9"}},"Speak with the bears!"),i.a.createElement("form",{className:"needs-validation",onSubmit:this.handleSubmit},i.a.createElement("div",{className:"login-field"},i.a.createElement("input",{name:"email",placeholder:"Email Address",onChange:this.handleChange,value:a,className:this.handleInputError(n,"email"),type:"email",spellCheck:"false"})),i.a.createElement("div",{className:"login-field"},i.a.createElement("input",{name:"password",placeholder:"Password",onChange:this.handleChange,value:t,className:this.handleInputError(n,"password"),type:"password",spellCheck:"false"})),i.a.createElement(h.b,{className:"login-btn",color:"dark",type:"submit"},"Login")),i.a.createElement("hr",null),i.a.createElement("p",null,"Don't have an account? ",i.a.createElement(A.b,{to:"/register"},"Register")),n.length>0&&i.a.createElement("div",null,i.a.createElement("h3",{className:"loginError"},"Oh no!"),this.displayErrors(n))))),i.a.createElement("div",{className:"login-page-mobile"},i.a.createElement("h2",null,"BearChat"),i.a.createElement("p",{style:{color:"#A9A9A9"}},"Speak with the bears!"),i.a.createElement("form",{className:"needs-validation",onSubmit:this.handleSubmit},i.a.createElement("div",{className:"login-field"},i.a.createElement("input",{name:"email",placeholder:"Email Address",onChange:this.handleChange,value:a,className:"form-control"+this.handleInputError(n,"email"),type:"email",spellCheck:"false"})),i.a.createElement("div",{className:"login-field"},i.a.createElement("input",{name:"password",placeholder:"Password",onChange:this.handleChange,value:t,className:"form-control"+this.handleInputError(n,"password"),type:"password",spellCheck:"false"})),i.a.createElement(h.b,{color:"dark",type:"submit",className:"login-btn"},"Login")),i.a.createElement("p",null,"Don't have an account? ",i.a.createElement(A.b,{to:"/register"},"Register")),n.length>0&&i.a.createElement("div",null,i.a.createElement("h3",{className:"loginError"},"Oh no!"),this.displayErrors(n))),i.a.createElement(te,null))}}]),a}(i.a.Component),re=t(241),se=t.n(re),le=function(e){function a(){var e,t;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(t=Object(s.a)(this,(e=Object(l.a)(a)).call.apply(e,[this].concat(o)))).state={username:"",email:"",password:"",passwordConfirmation:"",errors:[],loading:!1,usersRef:v.database().ref("users")},t.isFormValid=function(){var e,a=[];return t.isFormEmpty(t.state)?(e={message:"Seems you didn't fill in all the fields"},t.setState({errors:a.concat(e)}),!1):!!t.isPasswordValid(t.state)||(e={message:"Password is invalid"},t.setState({errors:a.concat(e)}),!1)},t.isFormEmpty=function(e){var a=e.username,t=e.email,n=e.password,r=e.passwordConfirmation;return!a.length||!t.length||!n.length||!r.length},t.isPasswordValid=function(e){var a=e.password,t=e.passwordConfirmation;return!(a.length<6||t.length<6)&&a===t},t.displayErrors=function(e){return e.map(function(e,a){return i.a.createElement("p",{key:a},e.message)})},t.handleChange=function(e){t.setState(Object(N.a)({},e.target.name,e.target.value))},t.handleSubmit=function(e){e.preventDefault(),t.isFormValid()&&(t.setState({errors:[],loading:!0}),v.auth().createUserWithEmailAndPassword(t.state.email,t.state.password).then(function(e){console.log(e),e.user.updateProfile({displayName:t.state.username,photoURL:"http://gravatar.com/avatar/".concat(se()(e.user.email),"?d=identicon")}).then(function(){t.saveUser(e).then(function(){console.log("user saved")})}).catch(function(e){console.error(e),t.setState({errors:t.state.errors.concat(e),loading:!1})})}).catch(function(e){console.error(e),t.setState({errors:t.state.errors.concat(e),loading:!1})}))},t.saveUser=function(e){return t.state.usersRef.child(e.user.uid).set({name:e.user.displayName,avatar:e.user.photoURL})},t.handleInputError=function(e,a){return e.some(function(e){return e.message.toLowerCase().includes(a)})?"error":""},t}return Object(o.a)(a,e),Object(r.a)(a,[{key:"render",value:function(){var e=this.state,a=e.username,t=e.email,n=e.password,r=e.passwordConfirmation,s=e.errors;e.loading;return i.a.createElement("div",null,i.a.createElement("div",{className:"login-page-desk"},i.a.createElement(h.c,{className:"register-card"},i.a.createElement(h.d,null,i.a.createElement("h2",null,"BearChat"),i.a.createElement("p",{style:{color:"#A9A9A9"}},"Speak with the bears!"),i.a.createElement("form",{className:"needs-validation",onSubmit:this.handleSubmit},i.a.createElement("div",{className:"login-field"},i.a.createElement("input",{name:"username",placeholder:"Username",onChange:this.handleChange,value:a,type:"text",spellCheck:"false"})),i.a.createElement("div",{className:"login-field"},i.a.createElement("input",{name:"email",placeholder:"Email Address",onChange:this.handleChange,value:t,className:this.handleInputError(s,"email"),type:"email",spellCheck:"false"})),i.a.createElement("div",{className:"login-field"},i.a.createElement("input",{name:"password",placeholder:"Password",onChange:this.handleChange,value:n,className:this.handleInputError(s,"password"),type:"password",spellCheck:"false"})),i.a.createElement("div",{className:"login-field"},i.a.createElement("input",{name:"passwordConfirmation",placeholder:"Password Confirmation",onChange:this.handleChange,value:r,className:this.handleInputError(s,"password"),type:"password",spellCheck:"false"})),i.a.createElement(h.b,{color:"dark",type:"submit",className:"login-btn"},"Register")),i.a.createElement("hr",null),i.a.createElement("p",null,"Already a user? ",i.a.createElement(A.b,{to:"/login"},"Login")),s.length>0&&i.a.createElement("div",{className:"loginError"},i.a.createElement("hr",null),i.a.createElement("h3",null,"Oh no!"),this.displayErrors(s))))),i.a.createElement("div",{className:"login-page-mobile"},i.a.createElement("h2",null,"BearChat"),i.a.createElement("p",{style:{color:"#A9A9A9"}},"Speak with the bears!"),i.a.createElement("form",{className:"needs-validation",onSubmit:this.handleSubmit},i.a.createElement("div",{className:"login-field"},i.a.createElement("input",{name:"username",placeholder:"Username",onChange:this.handleChange,value:a,type:"text",spellCheck:"false"})),i.a.createElement("div",{className:"login-field"},i.a.createElement("input",{name:"email",placeholder:"Email Address",onChange:this.handleChange,value:t,className:this.handleInputError(s,"email"),type:"email",spellCheck:"false"})),i.a.createElement("div",{className:"login-field"},i.a.createElement("input",{name:"password",placeholder:"Password",onChange:this.handleChange,value:n,className:this.handleInputError(s,"password"),type:"password",spellCheck:"false"})),i.a.createElement("div",{className:"login-field"},i.a.createElement("input",{name:"passwordConfirmation",placeholder:"Password Confirmation",onChange:this.handleChange,value:r,className:this.handleInputError(s,"password"),type:"password",spellCheck:"false"})),i.a.createElement(h.b,{color:"dark",type:"submit",className:"login-btn"},"Register")),i.a.createElement("p",null,"Already a user? ",i.a.createElement(A.b,{to:"/Login"},"Login")),s.length>0&&i.a.createElement("div",null,i.a.createElement("h3",{className:"loginError"},"Oh no!"),this.displayErrors(s))),i.a.createElement(te,null))}}]),a}(i.a.Component),oe=t(561),ce=t(560),ie=function(){return i.a.createElement(oe.a,{active:!0},i.a.createElement(ce.a,{size:"huge",content:"Preparing Chat..."}))},ue=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function de(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}t(549),t(550),t(551),t(552),t(553);var me=t(53),he=t(59),pe=t(250),fe={currentUser:null,isLoading:!0},ge={currentChannel:null,isPrivateChannel:!1,userPosts:null},ve=Object(he.combineReducers)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"SET_USER":return{currentUser:a.payload.currentUser,isLoading:!1};case"CLEAR_USER":return Object(R.a)({},e,{isLoading:!1});default:return e}},channel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"SET_CURRENT_CHANNEL":return Object(R.a)({},e,{currentChannel:a.payload.currentChannel});case"SET_PRIVATE_CHANNEL":return Object(R.a)({},e,{isPrivateChannel:a.payload.isPrivateChannel});case"SET_USER_POSTS":return Object(R.a)({},e,{userPosts:a.payload.userPosts});default:return e}}}),Ee=Object(he.createStore)(ve,Object(pe.composeWithDevTools)()),Ce=function(e){function a(){return Object(n.a)(this,a),Object(s.a)(this,Object(l.a)(a).apply(this,arguments))}return Object(o.a)(a,e),Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=this;v.auth().onAuthStateChanged(function(a){a?(e.props.setUser(a),e.props.history.push("/")):(e.props.history.push("/login"),e.props.clearUser())})}},{key:"render",value:function(){return this.props.isLoading?i.a.createElement(ie,null):i.a.createElement(me.c,null,i.a.createElement(me.a,{exact:!0,path:"/",component:ee}),i.a.createElement(me.a,{exact:!0,path:"/Profile",component:ae}),i.a.createElement(me.a,{path:"/login",component:ne}),i.a.createElement(me.a,{path:"/register",component:le}))}}]),a}(i.a.Component),be=Object(me.f)(Object(m.b)(function(e){return{isLoading:e.user.isLoading}},{setUser:function(e){return{type:"SET_USER",payload:{currentUser:e}}},clearUser:function(){return{type:"CLEAR_USER"}}})(Ce));d.a.render(i.a.createElement(m.a,{store:Ee},i.a.createElement(A.a,null,i.a.createElement(be,null))),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");ue?function(e){fetch(e).then(function(a){404===a.status||-1===a.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):de(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):de(e)})}}()}},[[262,1,2]]]);
//# sourceMappingURL=main.c4b1c86b.chunk.js.map